# 课程内容
https://ke.qq.com/webcourse/index.html#cid=436711&term_id=100521479&taid=3803588678035943&vid=5285890793094446853
1.索引数据结构红黑树，Hash,B+树详解
2.索引是怎么支撑千万级表的快速查找
3.如何基于索引B+树精准建立高性能索引
4.联合索引底层数据结构又是怎样的
5.Mysql索引优化最佳实践

# 
索引的本质
*索引是帮助MySQL高效获取数据的排好序的数据结构
*索引数据结构
1>二叉树：
 有可能演变成单向的链表结构
2>红黑树：
  也叫二叉平衡树。数据太多的时候红黑树的高度会很高，查找元素的最多次数就高度
3>Hash表
针对一个值的查找是很快，但是对于范围查找hash表是不能支持的。
4>B-Tree
  叶节点具有相同的深度
  叶节点的指针为空
  节点中的数据索引从左到右递增排列
  
MySql底层使用的是B-Tree的变种B+Tree
B+Tree(B-Tree变种)
  非叶子节点不存储data,只存储索引，可以放更多的索引
  顺序访问指针，提高区间访问的性能
  
# 索引是怎么支撑千万级表的快速查找的
mysql中定义的B+Tree节点的大小是16kb
一般我们定义主键是bigint类型，是一个8B的大小
索引节点大小 = 8B + 磁盘文件指针大小6B（源码中设定的）=14b
16kb/14b=1170个，一个非叶子节点可以存储1170个元素
假设叶子节点中一个完整记录索引加data占用1kb
16kb/1kb=16个，一个叶子节点大概可以存储16个元素
一个高度为3的b+tree叶子节点全部存储满了可以存储多少个节点数？
1170*1170*16=2000多万

# 数据表存储引擎索引实现
MyISAM存储引擎索引实现
MyISAM索引文件和数据文件是分离的(非聚集)
.frm文件存储表结构
.MYD文件存储表数据行
.MYI文件存储索引

InnoDB存储引擎索引实现
InnoDB索引实现（聚集）
  表数据文件本身就是按B+Tree组织的一个索引结构文件
  聚集索引-叶节点包含了完整的数据记录
  为什么InnoDB表必须有主键，并且推荐使用整型的自增主键？
    整型比较大小会比较快
    自增会避免导致叶子节点分裂，只需要往后插入叶子节点即可
  为什么非主键索引结构叶子节点存储的是主键值？（一致性和节省存储空间）
.frm文件存储表结构 
.ibd文件存储索引加数据

想比较MyISAM在查找数据时还需要到MYD文件中读取数据，而InnoDB直接就可以取到数据少一次磁盘I/O


聚集索引：叶子节点包含了完整的记录。也就是行记录数据和索引聚集在一个文件中。我们找到索引记录后就找到了完整的数据，不需要再进行一次磁盘I/O
非聚集索引：索引元素和对应的表数据不存储在一起的

MyISAM的主键索引就是非聚集索引
InnoDB的主键索引就是聚集索引


